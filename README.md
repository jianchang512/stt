<div align="center">

**ä¸­æ–‡ç®€ä½“** | [English](./docs/en/README_EN.md) | [PortuguÃªs (Brasil)](./docs/pt/README_pt-BR.md)

</div>

---

<div align="center">

[ğŸ‘‘ æåŠ©æœ¬é¡¹ç›®](https://github.com/jianchang512/pyvideotrans/blob/main/docs/about.md) | [Discordé‚€è¯·](https://discord.gg/SyT6GEwkJS)

</div>

---


# è¯­éŸ³è¯†åˆ«è½¬æ–‡å­—å·¥å…·

è¿™æ˜¯ä¸€ä¸ªç¦»çº¿è¿è¡Œçš„æœ¬åœ°è¯­éŸ³è¯†åˆ«è½¬æ–‡å­—å·¥å…·ï¼ŒåŸºäº fast-whipser å¼€æºæ¨¡å‹ï¼Œå¯å°†è§†é¢‘/éŸ³é¢‘ä¸­çš„äººç±»å£°éŸ³è¯†åˆ«å¹¶è½¬ä¸ºæ–‡å­—ï¼Œå¯è¾“å‡ºjsonæ ¼å¼ã€srtå­—å¹•å¸¦æ—¶é—´æˆ³æ ¼å¼ã€çº¯æ–‡å­—æ ¼å¼ã€‚å¯ç”¨äºè‡ªè¡Œéƒ¨ç½²åæ›¿ä»£ openai çš„è¯­éŸ³è¯†åˆ«æ¥å£æˆ–ç™¾åº¦è¯­éŸ³è¯†åˆ«ç­‰ï¼Œå‡†ç¡®ç‡åŸºæœ¬ç­‰åŒopenaiå®˜æ–¹apiæ¥å£ã€‚


fast-whisper å¼€æºæ¨¡å‹æœ‰ tiny/base/small/medium/large-v3, å†…ç½® tiny æ¨¡å‹ï¼Œtiny->large-v3è¯†åˆ«æ•ˆæœè¶Šæ¥è¶Šå¥½ï¼Œä½†æ‰€éœ€è®¡ç®—æœºèµ„æºä¹Ÿæ›´å¤šï¼Œæ ¹æ®éœ€è¦å¯è‡ªè¡Œä¸‹è½½åè§£å‹åˆ° models ç›®å½•ä¸‹å³å¯ã€‚

> **[èµåŠ©å•†]**
> 
> [![](https://github.com/user-attachments/assets/5348c86e-2d5f-44c7-bc1b-3cc5f077e710)](https://gpt302.saaslink.net/teRK8Y)
>  [302.AI](https://gpt302.saaslink.net/teRK8Y)æ˜¯ä¸€ä¸ªæŒ‰éœ€ä»˜è´¹çš„ä¸€ç«™å¼AIåº”ç”¨å¹³å°ï¼Œå¼€æ”¾å¹³å°ï¼Œå¼€æºç”Ÿæ€, [302.AIå¼€æºåœ°å€](https://github.com/302ai)
> 
> é›†åˆäº†æœ€æ–°æœ€å…¨çš„AIæ¨¡å‹å’Œå“ç‰Œ/æŒ‰éœ€ä»˜è´¹é›¶æœˆè´¹/ç®¡ç†å’Œä½¿ç”¨åˆ†ç¦»/æ‰€æœ‰AIèƒ½åŠ›å‡æä¾›API/æ¯å‘¨æ¨å‡º2-3ä¸ªæ–°åº”ç”¨



# è§†é¢‘æ¼”ç¤º


https://github.com/jianchang512/stt/assets/3378335/d716acb6-c20c-4174-9620-f574a7ff095d


![image](https://github.com/jianchang512/stt/assets/3378335/0f724ff1-21b3-4960-b6ba-5aa994ea414c)




# é¢„ç¼–è¯‘Winç‰ˆä½¿ç”¨æ–¹æ³•/Linuxå’ŒMacæºç éƒ¨ç½²

1. [ç‚¹å‡»æ­¤å¤„æ‰“å¼€Releasesé¡µé¢ä¸‹è½½](https://github.com/jianchang512/stt/releases)é¢„ç¼–è¯‘æ–‡ä»¶

2. ä¸‹è½½åè§£å‹åˆ°æŸå¤„ï¼Œæ¯”å¦‚ E:/stt

3. åŒå‡» start.exe ï¼Œç­‰å¾…è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨çª—å£å³å¯

4. ç‚¹å‡»é¡µé¢ä¸­çš„ä¸Šä¼ åŒºåŸŸï¼Œåœ¨å¼¹çª—ä¸­æ‰¾åˆ°æƒ³è¯†åˆ«çš„éŸ³é¢‘æˆ–è§†é¢‘æ–‡ä»¶ï¼Œæˆ–ç›´æ¥æ‹–æ‹½éŸ³é¢‘è§†é¢‘æ–‡ä»¶åˆ°ä¸Šä¼ åŒºåŸŸï¼Œç„¶åé€‰æ‹©å‘ç”Ÿè¯­è¨€ã€æ–‡æœ¬è¾“å‡ºæ ¼å¼ã€æ‰€ç”¨æ¨¡å‹ï¼Œç‚¹å‡»â€œç«‹å³å¼€å§‹è¯†åˆ«â€ï¼Œç¨ç­‰ç‰‡åˆ»ï¼Œåº•éƒ¨æ–‡æœ¬æ¡†ä¸­ä¼šä»¥æ‰€é€‰æ ¼å¼æ˜¾ç¤ºè¯†åˆ«ç»“æœ

5. å¦‚æœæœºå™¨æ‹¥æœ‰è‹±ä¼Ÿè¾¾GPUï¼Œå¹¶æ­£ç¡®é…ç½®äº†CUDAç¯å¢ƒï¼Œå°†è‡ªåŠ¨ä½¿ç”¨CUDAåŠ é€Ÿ


# æºç éƒ¨ç½²(Linux/Mac/Window)

0. è¦æ±‚ python 3.9->3.11

1. åˆ›å»ºç©ºç›®å½•ï¼Œæ¯”å¦‚ E:/stt, åœ¨è¿™ä¸ªç›®å½•ä¸‹æ‰“å¼€ cmd çª—å£ï¼Œæ–¹æ³•æ˜¯åœ°å€æ ä¸­è¾“å…¥ `cmd`, ç„¶åå›è½¦ã€‚

	ä½¿ç”¨gitæ‹‰å–æºç åˆ°å½“å‰ç›®å½• ` git clone git@github.com:jianchang512/stt.git . `

2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ `python -m venv venv`

3. æ¿€æ´»ç¯å¢ƒï¼Œwinä¸‹å‘½ä»¤ `%cd%/venv/scripts/activate`ï¼Œlinuxå’ŒMacä¸‹å‘½ä»¤ `source ./venv/bin/activate`

4. å®‰è£…ä¾èµ–: `pip install -r requirements.txt`,å¦‚æœæŠ¥ç‰ˆæœ¬å†²çªé”™è¯¯ï¼Œè¯·æ‰§è¡Œ `pip install -r requirements.txt --no-deps` ,å¦‚æœå¸Œæœ›æ”¯æŒcudaåŠ é€Ÿï¼Œç»§ç»­æ‰§è¡Œä»£ç  `pip uninstall -y torch`, `pip install torch --index-url https://download.pytorch.org/whl/cu121`

5. winä¸‹è§£å‹ ffmpeg.7zï¼Œå°†å…¶ä¸­çš„`ffmpeg.exe`å’Œ`ffprobe.exe`æ”¾åœ¨é¡¹ç›®ç›®å½•ä¸‹, linuxå’Œmac è‡ªè¡Œæœç´¢ å¦‚ä½•å®‰è£…ffmpeg

6. [ä¸‹è½½æ¨¡å‹å‹ç¼©åŒ…](https://github.com/jianchang512/stt/releases/tag/0.0)ï¼Œæ ¹æ®éœ€è¦ä¸‹è½½æ¨¡å‹ï¼Œä¸‹è½½åå°†å‹ç¼©åŒ…é‡Œçš„æ–‡ä»¶å¤¹æ”¾åˆ°é¡¹ç›®æ ¹ç›®å½•çš„ models æ–‡ä»¶å¤¹å†…

7. æ‰§è¡Œ  `python  start.py `ï¼Œç­‰å¾…è‡ªåŠ¨æ‰“å¼€æœ¬åœ°æµè§ˆå™¨çª—å£ã€‚


# Apiæ¥å£

æ¥å£åœ°å€: http://127.0.0.1:9977/api

è¯·æ±‚æ–¹æ³•: POST

è¯·æ±‚å‚æ•°:

    language: è¯­è¨€ä»£ç :å¯é€‰å¦‚ä¸‹

    >
    > ä¸­æ–‡ï¼šzh
    > è‹±è¯­ï¼šen
    > æ³•è¯­ï¼šfr
    > å¾·è¯­ï¼šde
    > æ—¥è¯­ï¼šja
    > éŸ©è¯­ï¼ško
    > ä¿„è¯­ï¼šru
    > è¥¿ç­ç‰™è¯­ï¼šes
    > æ³°å›½è¯­ï¼šth
    > æ„å¤§åˆ©è¯­ï¼šit
    > è‘¡è„ç‰™è¯­ï¼špt
    > è¶Šå—è¯­ï¼švi
    > é˜¿æ‹‰ä¼¯è¯­ï¼šar
    > åœŸè€³å…¶è¯­ï¼štr
    >

    model: æ¨¡å‹åç§°ï¼Œå¯é€‰å¦‚ä¸‹
    >
    > base å¯¹åº”äº models/models--Systran--faster-whisper-base
    > small å¯¹åº”äº models/models--Systran--faster-whisper-small
    > medium å¯¹åº”äº models/models--Systran--faster-whisper-medium
    > large-v3 å¯¹åº”äº models/models--Systran--faster-whisper-large-v3
    >

    response_format: è¿”å›çš„å­—å¹•æ ¼å¼ï¼Œå¯é€‰ text|json|srt

    file: éŸ³è§†é¢‘æ–‡ä»¶ï¼ŒäºŒè¿›åˆ¶ä¸Šä¼ 

Api è¯·æ±‚ç¤ºä¾‹

```python
    import requests
    # è¯·æ±‚åœ°å€
    url = "http://127.0.0.1:9977/api"
    # è¯·æ±‚å‚æ•°  file:éŸ³è§†é¢‘æ–‡ä»¶ï¼Œlanguageï¼šè¯­è¨€ä»£ç ï¼Œmodelï¼šæ¨¡å‹ï¼Œresponse_format:text|json|srt
    # è¿”å› code==0 æˆåŠŸï¼Œå…¶ä»–å¤±è´¥ï¼Œmsg==æˆåŠŸä¸ºokï¼Œå…¶ä»–å¤±è´¥åŸå› ï¼Œdata=è¯†åˆ«åè¿”å›æ–‡å­—
    files = {"file": open("C:/Users/c1/Videos/2.wav", "rb")}
    data={"language":"zh","model":"base","response_format":"json"}
    response = requests.request("POST", url, timeout=600, data=data,files=files)
    print(response.json())
```



# CUDA åŠ é€Ÿæ”¯æŒ

**å®‰è£…CUDAå·¥å…·** [è¯¦ç»†å®‰è£…æ–¹æ³•](https://juejin.cn/post/7318704408727519270)

å¦‚æœä½ çš„ç”µè„‘æ‹¥æœ‰ Nvidia æ˜¾å¡ï¼Œå…ˆå‡çº§æ˜¾å¡é©±åŠ¨åˆ°æœ€æ–°ï¼Œç„¶åå»å®‰è£…å¯¹åº”çš„ 
   [CUDA Toolkit](https://developer.nvidia.com/cuda-downloads)  å’Œ  [cudnn for CUDA11.X](https://developer.nvidia.com/rdp/cudnn-archive)ã€‚
   
   å®‰è£…å®Œæˆæˆï¼ŒæŒ‰`Win + R`,è¾“å…¥ `cmd`ç„¶åå›è½¦ï¼Œåœ¨å¼¹å‡ºçš„çª—å£ä¸­è¾“å…¥`nvcc --version`,ç¡®è®¤æœ‰ç‰ˆæœ¬ä¿¡æ¯æ˜¾ç¤ºï¼Œç±»ä¼¼è¯¥å›¾
   ![image](https://github.com/jianchang512/pyvideotrans/assets/3378335/e68de07f-4bb1-4fc9-bccd-8f841825915a)

   ç„¶åç»§ç»­è¾“å…¥`nvidia-smi`,ç¡®è®¤æœ‰è¾“å‡ºä¿¡æ¯ï¼Œå¹¶ä¸”èƒ½çœ‹åˆ°cudaç‰ˆæœ¬å·ï¼Œç±»ä¼¼è¯¥å›¾
   ![image](https://github.com/jianchang512/pyvideotrans/assets/3378335/71f1d7d3-07f9-4579-b310-39284734006b)

    ç„¶åæ‰§è¡Œ `python testcuda.py`ï¼Œå¦‚æœæç¤ºæˆåŠŸï¼Œè¯´æ˜å®‰è£…æ­£ç¡®ï¼Œå¦åˆ™è¯·ä»”ç»†æ£€æŸ¥é‡æ–°å®‰è£…
    
    é»˜è®¤ä½¿ç”¨ cpu è¿ç®—ï¼Œå¦‚æœç¡®å®šä½¿ç”¨è‹±ä¼Ÿè¾¾æ˜¾å¡ï¼Œå¹¶ä¸”é…ç½®å¥½äº†cudaç¯å¢ƒï¼Œè¯·ä¿®æ”¹ set.ini ä¸­ `devtype=cpu`ä¸º `devtype=cuda`,å¹¶é‡æ–°å¯åŠ¨ï¼Œå¯ä½¿ç”¨cudaåŠ é€Ÿ

# æ³¨æ„äº‹é¡¹

0. å¦‚æœæ²¡æœ‰è‹±ä¼Ÿè¾¾æ˜¾å¡æˆ–æœªé…ç½®å¥½CUDAç¯å¢ƒï¼Œä¸è¦ä½¿ç”¨ large/large-v3 æ¨¡å‹ï¼Œå¯èƒ½å¯¼è‡´å†…å­˜è€—å°½æ­»æœº
1. ä¸­æ–‡åœ¨æŸäº›æƒ…å†µä¸‹ä¼šè¾“å‡ºç¹ä½“å­—
2. æœ‰æ—¶ä¼šé‡åˆ°â€œcublasxx.dllä¸å­˜åœ¨â€çš„é”™è¯¯ï¼Œæ­¤æ—¶éœ€è¦ä¸‹è½½ cuBLASï¼Œç„¶åå°†dllæ–‡ä»¶å¤åˆ¶åˆ°ç³»ç»Ÿç›®å½•ä¸‹ï¼Œ[ç‚¹å‡»ä¸‹è½½ cuBLAS](https://github.com/jianchang512/stt/releases/download/0.0/cuBLAS_win.7z)ï¼Œè§£å‹åå°†é‡Œé¢çš„dllæ–‡ä»¶å¤åˆ¶åˆ° C:/Windows/System32ä¸‹
3. å¦‚æœæ§åˆ¶å°å‡ºç°"[W:onnxruntime:Default, onnxruntime_pybind_state.cc:1983 onnxruntime::python::CreateInferencePybindStateModule] Init provider bridge failed.", å¯å¿½ç•¥ï¼Œä¸å½±å“ä½¿ç”¨
4. é»˜è®¤ä½¿ç”¨ cpu è¿ç®—ï¼Œå¦‚æœç¡®å®šä½¿ç”¨è‹±ä¼Ÿè¾¾æ˜¾å¡ï¼Œå¹¶ä¸”é…ç½®å¥½äº†cudaç¯å¢ƒï¼Œè¯·ä¿®æ”¹ set.ini ä¸­ `devtype=cpu`ä¸º `devtype=cuda`,å¹¶é‡æ–°å¯åŠ¨ï¼Œå¯ä½¿ç”¨cudaåŠ é€Ÿ



5. å°šæœªæ‰§è¡Œå®Œæ¯•å°±é—ªé€€

å¦‚æœå¯ç”¨äº†cudaå¹¶ä¸”ç”µè„‘å·²å®‰è£…å¥½äº†cudaç¯å¢ƒï¼Œä½†æ²¡æœ‰æ‰‹åŠ¨å®‰è£…é…ç½®è¿‡cudnnï¼Œé‚£ä¹ˆä¼šå‡ºç°è¯¥é—®é¢˜ï¼Œå»å®‰è£…å’ŒcudaåŒ¹é…çš„cudnnã€‚æ¯”å¦‚ä½ å®‰è£…äº†cuda12.3ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸‹è½½cudnn for cuda12.xå‹ç¼©åŒ…ï¼Œç„¶åè§£å‹åé‡Œé¢çš„3ä¸ªæ–‡ä»¶å¤¹å¤åˆ¶åˆ°cudaå®‰è£…ç›®å½•ä¸‹ã€‚å…·ä½“æ•™ç¨‹å‚è€ƒ https://juejin.cn/post/7318704408727519270

å¦‚æœcudnnæŒ‰ç…§æ•™ç¨‹å®‰è£…å¥½äº†ä»é—ªé€€ï¼Œé‚£ä¹ˆæå¤§æ¦‚ç‡æ˜¯GPUæ˜¾å­˜ä¸è¶³ï¼Œå¯ä»¥æ”¹ä¸ºä½¿ç”¨ mediumæ¨¡å‹ï¼Œæ˜¾å­˜ä¸è¶³8Gæ—¶ï¼Œå°½é‡é¿å…ä½¿ç”¨largev-3æ¨¡å‹ï¼Œå°¤å…¶æ˜¯è§†é¢‘å¤§äº20Mæ—¶ï¼Œå¦åˆ™å¯èƒ½æ˜¾å­˜ä¸è¶³è€Œå´©æºƒ

# ç›¸å…³è”é¡¹ç›®

[è§†é¢‘ç¿»è¯‘é…éŸ³å·¥å…·:ç¿»è¯‘å­—å¹•å¹¶é…éŸ³](https://github.com/jianchang512/pyvideotrans)

[å£°éŸ³å…‹éš†å·¥å…·:ç”¨ä»»æ„éŸ³è‰²åˆæˆè¯­éŸ³](https://github.com/jianchang512/clone-voice)

[äººå£°èƒŒæ™¯ä¹åˆ†ç¦»:æç®€çš„äººå£°å’ŒèƒŒæ™¯éŸ³ä¹åˆ†ç¦»å·¥å…·ï¼Œæœ¬åœ°åŒ–ç½‘é¡µæ“ä½œ](https://github.com/jianchang512/vocal-separate)

# è‡´è°¢

æœ¬é¡¹ç›®ä¸»è¦ä¾èµ–çš„å…¶ä»–é¡¹ç›®

1. https://github.com/SYSTRAN/faster-whisper
2. https://github.com/pallets/flask
3. https://ffmpeg.org/
4. https://layui.dev

